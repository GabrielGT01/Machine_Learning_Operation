[ 2025-07-09 14:47:14,676 ] 33 root - INFO - Initiating data reading and processing
[ 2025-07-09 14:47:14,676 ] 186 root - INFO - Starting data ingestion process
[ 2025-07-09 14:47:14,676 ] 58 root - INFO - Reading train and test data sources
[ 2025-07-09 14:47:14,720 ] 70 root - INFO - Loaded 48326 training and 46621 test records
[ 2025-07-09 14:47:14,721 ] 85 root - INFO - Dropped 16 columns from training data
[ 2025-07-09 14:47:14,721 ] 90 root - INFO - Dropped 16 columns from test data
[ 2025-07-09 14:47:14,722 ] 96 root - INFO - Data transformation completed successfully
[ 2025-07-09 14:47:14,722 ] 121 root - INFO - Required columns: ['lpep_pickup_datetime', 'lpep_dropoff_datetime', 'PULocationID', 'DOLocationID', 'trip_distance']
[ 2025-07-09 14:47:14,722 ] 122 root - INFO - Train columns: ['lpep_pickup_datetime', 'lpep_dropoff_datetime', 'PULocationID', 'DOLocationID', 'trip_distance']
[ 2025-07-09 14:47:14,722 ] 123 root - INFO - Test columns: ['lpep_pickup_datetime', 'lpep_dropoff_datetime', 'PULocationID', 'DOLocationID', 'trip_distance']
[ 2025-07-09 14:47:14,722 ] 128 root - INFO - Train Column validation passed.
[ 2025-07-09 14:47:14,722 ] 141 root - INFO - Test Column validation passed.
[ 2025-07-09 14:47:14,723 ] 167 root - INFO - Created directory: ingested_data/untransformed_data-07_09_2025_14_47_12
[ 2025-07-09 14:47:15,113 ] 173 root - INFO - Dataframes successfully saved to local machine
[ 2025-07-09 14:47:15,113 ] 205 root - INFO - Data ingestion completed successfully
[ 2025-07-09 14:47:15,113 ] 42 root - INFO - Transforming data
[ 2025-07-09 14:47:15,113 ] 137 root - INFO - Starting data transformation
[ 2025-07-09 14:47:15,206 ] 142 root - INFO - Read both test and train data successfully
[ 2025-07-09 14:47:15,210 ] 145 root - INFO - Train data missing values:
lpep_pickup_datetime     0
lpep_dropoff_datetime    0
PULocationID             0
DOLocationID             0
trip_distance            0
dtype: int64
[ 2025-07-09 14:47:15,213 ] 146 root - INFO - Test data missing values:
lpep_pickup_datetime     0
lpep_dropoff_datetime    0
PULocationID             0
DOLocationID             0
trip_distance            0
dtype: int64
[ 2025-07-09 14:47:15,282 ] 150 root - INFO - created the duration target column
[ 2025-07-09 14:47:15,283 ] 155 root - INFO - Split the train data into features and target
[ 2025-07-09 14:47:15,284 ] 159 root - INFO - Split the test data into features and target
[ 2025-07-09 14:47:15,284 ] 76 root - INFO - creating encoders and imputers
[ 2025-07-09 14:47:15,284 ] 89 root - INFO - Initiating encoders and scaling
[ 2025-07-09 14:47:15,284 ] 165 root - INFO - Applying transformations on training data
[ 2025-07-09 14:47:15,339 ] 167 root - INFO - Applying transformations on test data
[ 2025-07-09 14:47:15,354 ] 171 root - INFO - concatenate the transformed array
[ 2025-07-09 14:47:15,355 ] 179 root - INFO - Transformation completed successfully
[ 2025-07-09 14:47:15,355 ] 180 root - INFO - Transformed train array shape: (37339, 4)
[ 2025-07-09 14:47:15,355 ] 181 root - INFO - Transformed test array shape: (36109, 4)
[ 2025-07-09 14:47:15,355 ] 184 root - INFO - saving the train, test and transformer
[ 2025-07-09 14:47:15,356 ] 64 root - INFO - Entered the save_object method class
[ 2025-07-09 14:47:15,359 ] 68 root - INFO - Exited the save_object method class
[ 2025-07-09 14:47:15,359 ] 196 root - INFO - Data transformation artifact: DataTransformationArtifact(transformed_object_file_path='ingested_data/model-07_09_2025_14_47_15/preprocessing.pkl', transformed_train_file_path='ingested_data/transformed_data-07_09_2025_14_47_15/train.npy', transformed_test_file_path='ingested_data/transformed_data-07_09_2025_14_47_15/test.npy')
[ 2025-07-09 14:47:15,361 ] 53 root - INFO - Transforming ended
[ 2025-07-09 14:47:15,361 ] 55 root - INFO - model training
[ 2025-07-09 14:47:15,770 ] 60 root - INFO - Starting ModelTrainer initialization and setting up mlflow
[ 2025-07-09 14:47:15,770 ] 62 root - INFO - tracking URI: 'http://127.0.0.1:5000'
[ 2025-07-09 14:47:15,770 ] 308 root - INFO - Starting model trainer pipeline
[ 2025-07-09 14:47:15,770 ] 313 root - INFO - Loading training data from: ingested_data/transformed_data-07_09_2025_14_47_15/train.npy
[ 2025-07-09 14:47:15,770 ] 314 root - INFO - Loading test data from: ingested_data/transformed_data-07_09_2025_14_47_15/test.npy
[ 2025-07-09 14:47:15,771 ] 320 root - INFO - Training array shape: (37339, 4)
[ 2025-07-09 14:47:15,771 ] 321 root - INFO - Test array shape: (36109, 4)
[ 2025-07-09 14:47:15,772 ] 331 root - INFO - Data split completed - features and target separated
[ 2025-07-09 14:47:15,772 ] 332 root - INFO - x_train shape: (37339, 3), y_train shape: (37339,)
[ 2025-07-09 14:47:15,772 ] 333 root - INFO - x_test shape: (36109, 3), y_test shape: (36109,)
[ 2025-07-09 14:47:15,772 ] 336 root - INFO - Calling train_model method
[ 2025-07-09 14:47:15,772 ] 74 root - INFO - Active MLflow run detected, ending it safely
[ 2025-07-09 14:47:15,790 ] 76 root - INFO - Previous MLflow run ended successfully
[ 2025-07-09 14:47:15,840 ] 141 root - INFO - Starting model training process
[ 2025-07-09 14:47:15,840 ] 142 root - INFO - Training data shape: X_train=(37339, 3), y_train=(37339,)
[ 2025-07-09 14:47:15,840 ] 143 root - INFO - Test data shape: X_test=(36109, 3), y_test=(36109,)
[ 2025-07-09 14:47:15,840 ] 145 root - INFO - Loading the Xgboost model
[ 2025-07-09 14:47:15,959 ] 150 root - INFO - Making predictions with the model
[ 2025-07-09 14:47:15,973 ] 156 root - INFO - Calculating regression metrics
[ 2025-07-09 14:47:15,976 ] 188 root - INFO - Training metrics: (3.2265794130952075, 4.70954519350167, 0.6649866714411322)
[ 2025-07-09 14:47:15,977 ] 189 root - INFO - Test metrics: (3.4997494800063036, 5.676109506373089, 0.6115748137958483)
[ 2025-07-09 14:47:15,977 ] 190 root - INFO - logging MLflow metrics and params
[ 2025-07-09 14:47:20,346 ] 224 root - INFO - Model registered as: nyc-taxi-duration-model
[ 2025-07-09 14:47:20,349 ] 240 root - INFO - Preprocessor loaded successfully
[ 2025-07-09 14:47:20,357 ] 242 root - INFO - Preprocessor logged to MLflow successfully
[ 2025-07-09 14:47:20,357 ] 248 root - INFO - Starting model save process
[ 2025-07-09 14:47:20,357 ] 99 root - INFO - Model directory created/verified: ingested_data/model-07_09_2025_14_47_15
[ 2025-07-09 14:47:20,357 ] 109 root - INFO - Attempting to save model to: ingested_data/model-07_09_2025_14_47_15/my_model.ubj
[ 2025-07-09 14:47:20,358 ] 113 root - INFO - Model saved successfully to: ingested_data/model-07_09_2025_14_47_15/my_model.ubj
[ 2025-07-09 14:47:20,359 ] 118 root - INFO - Model file verified - Size: 116526 bytes
[ 2025-07-09 14:47:20,359 ] 255 root - INFO - Model saved successfully at: ingested_data/model-07_09_2025_14_47_15/my_model.ubj
[ 2025-07-09 14:47:20,359 ] 279 root - INFO - Model trainer artifact created: ModelTrainerArtifact(trained_model_file_path='ingested_data/model-07_09_2025_14_47_15/my_model.ubj', train_metric_artifact=RegressionMetricArtifact(mean_absolute_error=3.2265794130952075, root_mean_squared_error=4.70954519350167, r2_score=0.6649866714411322), test_metric_artifact=RegressionMetricArtifact(mean_absolute_error=3.4997494800063036, root_mean_squared_error=5.676109506373089, r2_score=0.6115748137958483), model_performance='good score', over_fitting_under_fitting=0.05341185764528389)
[ 2025-07-09 14:47:20,359 ] 280 root - INFO - Model training process completed successfully
[ 2025-07-09 14:47:20,387 ] 339 root - INFO - Model trainer pipeline completed successfully
[ 2025-07-09 14:47:20,387 ] 62 root - INFO - Model training ended
